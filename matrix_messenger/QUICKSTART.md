# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç Matrix Messenger

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ?

‚úÖ **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!**

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 10 –æ—à–∏–±–æ–∫:
- üî¥ 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (PostgreSQL, inventory, —à–∞–±–ª–æ–Ω—ã)
- üü° 6 —Å—Ä–µ–¥–Ω–∏—Ö (—Ç–µ—Å—Ç—ã, —Å–∫—Ä–∏–ø—Ç—ã, backup)

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [CHANGELOG_FIXES.md](CHANGELOG_FIXES.md)

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞ 3 —à–∞–≥–∞

### 1Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
cd /home/sigma/Projects/ansible_matrix_messenger/matrix_messenger

# –°–æ–∑–¥–∞–π .env —Ñ–∞–π–ª
cp env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏ ANSIBLE_HOST, ANSIBLE_USER, ANSIBLE_PASSWORD, –ø–∞—Ä–æ–ª–∏

# –°–æ–∑–¥–∞–π inventory
cp inventory.ini.example inventory.ini
nano inventory.ini  # –£–∫–∞–∂–∏ IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –≤–º–µ—Å—Ç–æ localhost
```

### 2Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```bash
source scripts/load_env.sh
```

–ò–ª–∏ —á–µ—Ä–µ–∑ Makefile:
```bash
make load-env
```

### 3Ô∏è‚É£ –î–µ–ø–ª–æ–π!

```bash
make deploy
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ Molecule:

```bash
make test
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:
```bash
molecule test
```

---

## üìù –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env

```bash
# –¢–≤–æ–π —Å–µ—Ä–≤–µ—Ä
ANSIBLE_HOST=192.168.1.100        # –ó–∞–º–µ–Ω–∏ –Ω–∞ IP —Ç–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
ANSIBLE_USER=ubuntu                # –ó–∞–º–µ–Ω–∏ –Ω–∞ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
ANSIBLE_PASSWORD=—Ç–≤–æ–π_–ø–∞—Ä–æ–ª—å       # –ü–∞—Ä–æ–ª—å –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

# –ü–∞—Ä–æ–ª–∏ Matrix
MATRIX_ADMIN_PASSWORD=–ø—Ä–∏–¥—É–º–∞–π_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å
POSTGRES_PASSWORD=–µ—â–µ_–æ–¥–∏–Ω_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å
```

---

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. **–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:**
   - –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `https://matrix.molokovklim.ru`
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –∫–ª–∏–µ–Ω—Ç Element: https://element.io

2. **–í–æ–π–¥–∏ –∫–∞–∫ –∞–¥–º–∏–Ω:**
   - –õ–æ–≥–∏–Ω: `@admin:matrix.molokovklim.ru`
   - –ü–∞—Ä–æ–ª—å: —Ç–æ—Ç —á—Ç–æ —É–∫–∞–∑–∞–ª –≤ `MATRIX_ADMIN_PASSWORD`

3. **–°–æ–∑–¥–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - –ò–ª–∏ –¥–æ–±–∞–≤—å –≤ `FAMILY_USERS` –≤ .env —Ñ–∞–π–ª–µ

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ!

- –§–∞–π–ª—ã `.env` –∏ `inventory.ini` **–ù–ï –∫–æ–º–º–∏—Ç—è—Ç—Å—è** –≤ git (–æ–Ω–∏ –≤ .gitignore)
- –î–ª—è production **–∏—Å–ø–æ–ª—å–∑—É–π SSH –∫–ª—é—á–∏** –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
- **–ü—Ä–æ–≤–µ—Ä—å DNS –∑–∞–ø–∏—Å–∏** –¥–ª—è –¥–æ–º–µ–Ω–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º (–¥–ª—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤)

---

## üÜò –ü–æ–º–æ—â—å

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `journalctl -u matrix-synapse -f`
2. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å: `systemctl status matrix-synapse`
3. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã: `molecule test`
4. –ü–æ—Å–º–æ—Ç—Ä–∏ [CHANGELOG_FIXES.md](CHANGELOG_FIXES.md)

---

**–ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**
