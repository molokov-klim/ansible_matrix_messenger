# План по исправлению ошибки с Ansible Vault в деплое

## Причины ошибки

1. **Пустой файл .vault_pass**:
   - В workflow используется команда `echo "" > .vault_pass`
   - Это создает пустой файл, который не содержит действительный пароль для Ansible Vault

2. **Неправильная настройка пароля**:
   - Пароль для Ansible Vault не передается из GitHub Secrets
   - Или передается неправильно

3. **Несоответствие паролей**:
   - Файл .vault_pass не содержит тот же пароль, который использовался для шифрования данных

## Решения

### Вариант 1: Использовать пароль из GitHub Secrets (рекомендуется)

Обновить workflow, чтобы:
- Получать пароль из GitHub Secrets (например, `VAULT_PASSWORD`)
- Записывать его в файл `.vault_pass`
- Использовать этот файл для расшифровки данных

### Вариант 2: Удалить использование Ansible Vault

Если зашифрованные данные не обязательны:
- Удалить зашифрованные данные из репозитория
- Использовать переменные окружения для передачи чувствительных данных

### Вариант 3: Использовать переменные окружения

Вместо Ansible Vault:
- Передавать чувствительные данные через переменные окружения
- Использовать их напрямую в плейбуках

## Рекомендуемое решение

Использовать Вариант 1, так как:
- Это обеспечивает безопасность чувствительных данных
- Сохраняет совместимость с существующей структурой
- Использует стандартный механизм GitHub Actions

## План действий

1. Убедиться, что в GitHub Secrets есть переменная `VAULT_PASSWORD` с правильным паролем
2. Обновить workflow, чтобы использовать пароль из `secrets.VAULT_PASSWORD`
3. Записать этот пароль в файл `.vault_pass`
4. Запустить деплой для проверки

## Проверка

После реализации:
- Убедиться, что файл `.vault_pass` содержит правильный пароль
- Проверить, что Ansible может расшифровать зашифрованные данные
- Убедиться, что деплой проходит успешно